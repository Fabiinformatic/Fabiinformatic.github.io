<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mi cuenta — LIXBY</title>
  <link rel="stylesheet" href="style.css">
  <style>
    :root { color-scheme: dark; }
    body { background: transparent; color: var(--text); font-family: 'Inter', system-ui, sans-serif; margin:0; }

    /* HEADER FIJO */
    header {
      position: sticky; top: 0; z-index: 1000;
      padding:12px 24px; display:flex; justify-content:space-between; align-items:center;
      background: rgba(15,20,27,0.85); border-bottom:1px solid #1b2230; backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .brand { font-weight:800; cursor:pointer; user-select:none; letter-spacing:0.04em; font-size:1.15rem; transition: color .18s var(--ease-bouncy);}
    .brand:focus-visible { outline: none; color: var(--accent); box-shadow: 0 0 0 4px var(--accent-soft);}
    .btn.ghost { background:transparent; border:1px solid var(--stroke); color:var(--text); }
    main {
      max-width:1100px; margin:50px auto 60px; padding:0 20px;
      display: grid; gap: 28px;
      animation: minimal-fade-in 0.88s var(--ease-bouncy) 0.07s 1 both;
    }
    @media (max-width:700px){ main { margin:24px auto 50px; padding:0 6px; } }
    .account-layout {
      display: grid; grid-template-columns: 340px 1fr; gap: 28px; align-items: flex-start;
    }
    @media (max-width:900px) {
      .account-layout { grid-template-columns:1fr; gap:18px; }
    }
    .glass-card {
      background: var(--bg-elev);
      border: 1px solid var(--stroke);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(14px) saturate(120%);
      -webkit-backdrop-filter: blur(14px) saturate(120%);
      padding: 32px 26px;
      position: relative;
      overflow: hidden;
      transition: box-shadow .45s var(--ease-bouncy), border-color .23s var(--ease-bouncy), background .23s var(--ease-bouncy);
      animation: minimal-fade-in 0.9s var(--ease-bouncy);
      opacity: 1;
    }
    .glass-card.section { margin-top:0; }
    h2 { margin-top:0; font-size:1.18rem; letter-spacing:0.01em; }
    .profile-avatar {
      width:100px; height:100px; border-radius:18px;
      background: linear-gradient(135deg, rgba(10,132,255,0.10), rgba(255,255,255,0.06));
      display:block; margin-bottom:14px; object-fit:cover;
      border: 2px solid var(--accent-soft);
      box-shadow: 0 4px 18px rgba(10,132,255,0.09);
      transition: box-shadow .26s var(--ease-bouncy), border-color .18s var(--ease-bouncy);
    }
    .profile-avatar:hover { box-shadow: 0 8px 32px rgba(10,132,255,0.15); border-color: var(--accent); }
    .profile-info { text-align:center; margin-bottom: 18px;}
    .profile-info h2 { margin-bottom:6px; }
    .muted { color:var(--muted); font-size:0.96em; }
    .profile-status {
      display:inline-block; margin-top:6px; padding:2px 10px;
      border-radius: 8px; background: var(--glass-strong); color:var(--accent); font-weight:600; font-size:0.9em;
    }
    .profile-actions { display:flex; gap:10px; justify-content:center; margin:18px 0 0; }
    .btn { padding:9px 16px; border-radius:var(--radius-md); font-weight:700; font-size:1em; }
    .btn[disabled] { opacity:.5; pointer-events:none; }
    .account-form label { display:block; margin-top:18px; font-weight:600; color:var(--muted);}
    .account-form input, .account-form textarea {
      width:100%; padding:10px; border-radius:9px; border:1px solid var(--stroke);
      background: rgba(255,255,255,0.03); color:var(--text); font-size:1em; margin-top:4px;
      transition: border-color .18s var(--ease-bouncy), box-shadow .18s var(--ease-bouncy);
    }
    .account-form input:focus, .account-form textarea:focus {
      border-color: var(--accent); outline: none; box-shadow: var(--focus-ring);
    }
    .save-actions { margin-top:22px; display:flex; gap:10px; }
    /* Secciones personales */
    .sections-list { display:grid; gap:22px; }
    .section-title {
      display:flex; align-items:center; gap:8px;
      font-size:1.06rem; font-weight:700; margin-bottom:10px;
    }
    .section-badge {
      background: var(--accent-soft); color: var(--accent);
      border-radius: 12px; padding:2px 10px; font-size:0.85em; font-weight:500;
    }
    .favorites-list, .orders-list, .purchased-list {
      display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      margin-top: 8px;
    }
    .favorite-card, .purchase-card, .order-card {
      background: var(--glass);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 14px;
      font-size:0.98em;
      min-height:40px;
      transition: box-shadow .28s var(--ease-bouncy), border-color .22s var(--ease-bouncy);
      display:flex; flex-direction:column; gap:7px;
      cursor:pointer;
      animation: minimal-fade-in 0.6s var(--ease-bouncy);
    }
    .favorite-card:hover, .purchase-card:hover, .order-card:hover {
      border-color: var(--accent-soft);
      box-shadow: 0 4px 18px rgba(10,132,255,0.08);
      background: var(--glass-strong);
    }
    .empty-state {
      color:var(--muted); font-size:0.97em; text-align:center; padding:18px 0; opacity:.8;
      animation: minimal-fade-in 1.1s var(--ease-bouncy);
    }
    /* Animación sutil de carga */
    .skeleton {
      background: linear-gradient(90deg, rgba(255,255,255,0.04) 25%, rgba(10,132,255,0.10) 50%, rgba(255,255,255,0.04) 75%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.4s infinite linear;
      border-radius: 8px; min-height: 32px;
    }
    @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* NEW STYLES FOR ADDED SECTIONS */
    .settings-group {
      margin-bottom: 24px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--stroke);
    }
    .settings-group:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    .settings-group-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--accent);
    }
    .settings-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .settings-item:last-child {
      border-bottom: none;
    }
    .settings-item-content {
      flex: 1;
    }
    .settings-item-label {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .settings-item-value {
      color: var(--muted);
      font-size: 0.9em;
    }
    .btn.small {
      padding: 6px 12px;
      font-size: 0.85em;
    }
    .btn.danger {
      background: #ff3b30;
      color: white;
      border: 1px solid #ff3b30;
    }
    .btn.danger:hover {
      background: #ff2d55;
      border-color: #ff2d55;
    }

    /* Orders filters */
    .orders-filters {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .filter-btn {
      padding: 6px 12px;
      border-radius: 16px;
      background: transparent;
      border: 1px solid var(--stroke);
      color: var(--text);
      font-size: 0.85em;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .filter-btn.active,
    .filter-btn:hover {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    /* Subscription styles */
    .subscription-info {
      margin-bottom: 24px;
    }
    .subscription-plan {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: var(--glass);
      border-radius: 12px;
      border: 1px solid var(--stroke);
    }
    .plan-details h3 {
      margin: 0 0 4px 0;
      font-size: 1.1rem;
    }
    .plan-price {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 4px;
    }
    .plan-renewal {
      color: var(--muted);
      font-size: 0.9em;
    }
    .plan-actions {
      display: flex;
      gap: 8px;
    }
    .billing-history h3 {
      margin-bottom: 16px;
      font-size: 1rem;
    }
    .invoice-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .invoice-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: var(--glass);
      border-radius: 8px;
      border: 1px solid var(--stroke);
    }
    .invoice-details {
      display: flex;
      flex-direction: column;
    }
    .invoice-date {
      font-weight: 500;
    }
    .invoice-amount {
      color: var(--accent);
      font-weight: 600;
    }

    /* Notification switches */
    .notification-settings {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .notification-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
    }
    .notification-content {
      flex: 1;
    }
    .notification-label {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .notification-description {
      color: var(--muted);
      font-size: 0.9em;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--stroke);
      transition: .3s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: var(--accent);
    }
    input:checked + .slider:before {
      transform: translateX(20px);
    }

    /* Devices list */
    .devices-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .device-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--glass);
      border-radius: 8px;
      border: 1px solid var(--stroke);
    }
    .device-icon {
      font-size: 1.5rem;
    }
    .device-info {
      flex: 1;
    }
    .device-name {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .device-details {
      color: var(--muted);
      font-size: 0.9em;
    }

    /* Activity list */
    .activity-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .activity-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px;
      background: var(--glass);
      border-radius: 8px;
      border: 1px solid var(--stroke);
    }
    .activity-icon {
      font-size: 1.2rem;
      margin-top: 2px;
    }
    .activity-content {
      flex: 1;
    }
    .activity-title {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .activity-details {
      color: var(--muted);
      font-size: 0.9em;
      margin-bottom: 2px;
    }
    .activity-time {
      color: var(--muted);
      font-size: 0.8em;
    }

    /* Support options */
    .support-options {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .support-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: var(--glass);
      border-radius: 12px;
      border: 1px solid var(--stroke);
      transition: all 0.2s ease;
    }
    .support-item:hover {
      border-color: var(--accent-soft);
      box-shadow: 0 4px 18px rgba(10,132,255,0.08);
    }
    .support-icon {
      font-size: 1.5rem;
    }
    .support-content {
      flex: 1;
    }
    .support-title {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .support-description {
      color: var(--muted);
      font-size: 0.9em;
    }

    /* Danger section */
    .danger-section {
      border-color: rgba(255, 59, 48, 0.3);
    }
    .danger-actions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .danger-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: rgba(255, 59, 48, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(255, 59, 48, 0.2);
    }
    .danger-content {
      flex: 1;
    }
    .danger-title {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .danger-description {
      color: var(--muted);
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <header>
    <div class="brand" id="brand" role="link" tabindex="0" aria-label="Ir al inicio">LIXBY</div>
    <a href="index.html" class="btn ghost">Volver</a>
  </header>

  <main>
    <div class="account-layout">
      <!-- Columna perfil -->
      <div class="glass-card" style="padding-bottom:20px;">
        <div class="profile-info">
          <img id="profileAvatar" class="profile-avatar" src="" alt="Avatar">
          <h2 id="profileName">Invitado</h2>
          <div id="profileEmail" class="muted" style="margin-bottom:4px;"></div>
          <div id="profileStatus" class="profile-status">No autenticado</div>
        </div>
        <div class="profile-actions">
          <button id="loginNowBtn" class="btn primary">Iniciar sesión</button>
          <button id="signOutBtn" class="btn ghost" style="display:none">Cerrar sesión</button>
        </div>
      </div>

      <!-- Columna información de la cuenta -->
      <form class="glass-card account-form" autocomplete="off" onsubmit="return false;">
        <h2>Información de la cuenta</h2>
        <label for="displayNameInput">Nombre visible</label>
        <input id="displayNameInput" type="text" placeholder="Tu nombre" autocomplete="name">
        <label for="phoneInput">Teléfono</label>
        <input id="phoneInput" type="text" placeholder="+34 600 000 000" autocomplete="tel">
        <label for="addressInput">Dirección de envío</label>
        <textarea id="addressInput" rows="2" autocomplete="street-address"></textarea>
        <div class="save-actions">
          <button id="saveProfileBtn" class="btn primary">Guardar cambios</button>
        </div>
      </form>
    </div>

    <div class="sections-list">
      <!-- ⚙️ SECCIÓN 1: Ajustes de la Cuenta -->
      <div class="glass-card section">
        <div class="section-title">
          <span>⚙️ Ajustes de la Cuenta</span>
          <span class="section-badge" id="accountSettingsBadge" style="display:none;">Configuración</span>
        </div>
        
        <!-- Información personal -->
        <div class="settings-group">
          <h3 class="settings-group-title">👤 Información personal</h3>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Nombre completo</div>
              <div class="settings-item-value" id="fullNameDisplay">No configurado</div>
            </div>
            <button class="btn ghost small" id="editPersonalBtn">Editar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Fecha de nacimiento</div>
              <div class="settings-item-value" id="birthDateDisplay">No configurado</div>
            </div>
            <button class="btn ghost small" id="editBirthDateBtn">Editar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">País o región</div>
              <div class="settings-item-value" id="countryDisplay">España</div>
            </div>
            <button class="btn ghost small" id="editCountryBtn">Cambiar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Idioma preferido</div>
              <div class="settings-item-value" id="languageDisplay">Español</div>
            </div>
            <button class="btn ghost small" id="editLanguageBtn">Cambiar</button>
          </div>
        </div>

        <!-- Seguridad -->
        <div class="settings-group">
          <h3 class="settings-group-title">🔒 Seguridad</h3>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Contraseña</div>
              <div class="settings-item-value">••••••••</div>
            </div>
            <button class="btn ghost small" id="changePasswordBtn">Cambiar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Verificación en dos pasos</div>
              <div class="settings-item-value" id="twoFactorStatus">Desactivado</div>
            </div>
            <button class="btn ghost small" id="toggleTwoFactorBtn">Activar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Dispositivos conectados</div>
              <div class="settings-item-value" id="devicesCount">3 dispositivos</div>
            </div>
            <button class="btn ghost small" id="viewDevicesBtn">Ver lista</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Sesiones activas</div>
              <div class="settings-item-value">2 sesiones</div>
            </div>
            <button class="btn ghost small" id="closeAllSessionsBtn">Cerrar todas</button>
          </div>
        </div>

        <!-- Privacidad -->
        <div class="settings-group">
          <h3 class="settings-group-title">🛡️ Privacidad</h3>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Preferencias de anuncios</div>
              <div class="settings-item-value">Personalizados</div>
            </div>
            <button class="btn ghost small" id="editAdsBtn">Configurar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Datos compartidos</div>
              <div class="settings-item-value">Limitado</div>
            </div>
            <button class="btn ghost small" id="editDataBtn">Gestionar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Descarga de datos</div>
              <div class="settings-item-value">Disponible</div>
            </div>
            <button class="btn ghost small" id="downloadDataBtn">Descargar</button>
          </div>
        </div>

        <!-- Métodos de pago -->
        <div class="settings-group">
          <h3 class="settings-group-title">💳 Métodos de pago</h3>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Tarjetas guardadas</div>
              <div class="settings-item-value" id="cardsCount">2 tarjetas</div>
            </div>
            <button class="btn ghost small" id="manageCardsBtn">Gestionar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Métodos alternativos</div>
              <div class="settings-item-value">PayPal, Apple Pay</div>
            </div>
            <button class="btn ghost small" id="manageMethodsBtn">Gestionar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Añadir método</div>
              <div class="settings-item-value">Nuevo método de pago</div>
            </div>
            <button class="btn primary small" id="addPaymentBtn">Añadir método</button>
          </div>
        </div>

        <!-- Direcciones -->
        <div class="settings-group">
          <h3 class="settings-group-title">📍 Direcciones</h3>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Dirección de envío</div>
              <div class="settings-item-value" id="shippingAddress">No configurada</div>
            </div>
            <button class="btn ghost small" id="editShippingBtn">Editar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Dirección de facturación</div>
              <div class="settings-item-value" id="billingAddress">No configurada</div>
            </div>
            <button class="btn ghost small" id="editBillingBtn">Editar</button>
          </div>
          <div class="settings-item">
            <div class="settings-item-content">
              <div class="settings-item-label">Añadir nueva dirección</div>
              <div class="settings-item-value">Crear nueva dirección</div>
            </div>
            <button class="btn primary small" id="addAddressBtn">Añadir nueva</button>
          </div>
        </div>
      </div>

      <!-- 🛍️ SECCIÓN 3: Pedidos o Compras -->
      <div class="glass-card section">
        <div class="section-title">
          <span>🛍️ Pedidos y Compras</span>
          <span class="section-badge" id="ordersBadge" style="display:none;">Historial</span>
        </div>
        
        <!-- Filtros -->
        <div class="orders-filters">
          <button class="filter-btn active" data-filter="all">Todos</button>
          <button class="filter-btn" data-filter="pending">Pendientes</button>
          <button class="filter-btn" data-filter="shipped">Enviados</button>
          <button class="filter-btn" data-filter="delivered">Entregados</button>
          <button class="filter-btn" data-filter="cancelled">Cancelados</button>
        </div>

        <div id="ordersList" class="orders-list">
          <div class="empty-state">Inicia sesión para ver tus pedidos y envíos.</div>
        </div>
      </div>

      <!-- 💳 SECCIÓN 4: Suscripciones y Facturación -->
      <div class="glass-card section">
        <div class="section-title">
          <span>💳 Suscripciones y Facturación</span>
          <span class="section-badge" id="subscriptionBadge" style="display:none;">Activo</span>
        </div>
        
        <div class="subscription-info">
          <div class="subscription-plan">
            <div class="plan-details">
              <h3 id="currentPlanName">Plan Básico</h3>
              <div class="plan-price" id="currentPlanPrice">€9.99/mes</div>
              <div class="plan-renewal" id="nextRenewal">Próxima renovación: 15 de enero, 2024</div>
            </div>
            <div class="plan-actions">
              <button class="btn ghost" id="changePlanBtn">Cambiar plan</button>
              <button class="btn ghost" id="cancelSubscriptionBtn">Cancelar</button>
            </div>
          </div>
        </div>

        <div class="billing-history">
          <h3>Historial de facturas</h3>
          <div class="invoice-list">
            <div class="invoice-item">
              <div class="invoice-details">
                <div class="invoice-date">15 de diciembre, 2023</div>
                <div class="invoice-amount">€9.99</div>
              </div>
              <button class="btn ghost small">Descargar PDF</button>
            </div>
            <div class="invoice-item">
              <div class="invoice-details">
                <div class="invoice-date">15 de noviembre, 2023</div>
                <div class="invoice-amount">€9.99</div>
              </div>
              <button class="btn ghost small">Descargar PDF</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 🔔 SECCIÓN 5: Notificaciones y Preferencias -->
      <div class="glass-card section">
        <div class="section-title">
          <span>🔔 Notificaciones y Preferencias</span>
          <span class="section-badge" id="notificationsBadge" style="display:none;">Configurado</span>
        </div>
        
        <div class="notification-settings">
          <div class="notification-item">
            <div class="notification-content">
              <div class="notification-label">Notificaciones por correo</div>
              <div class="notification-description">Recibe actualizaciones importantes por email</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="emailNotifications" checked>
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div class="notification-content">
              <div class="notification-label">Notificaciones push</div>
              <div class="notification-description">Recibe notificaciones en tu dispositivo</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="pushNotifications" checked>
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div class="notification-content">
              <div class="notification-label">Boletines y promociones</div>
              <div class="notification-description">Ofertas especiales y novedades</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="newsletterNotifications">
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="notification-item">
            <div class="notification-content">
              <div class="notification-label">Avisos de seguridad</div>
              <div class="notification-description">Alertas importantes de seguridad</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="securityNotifications" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>

      <!-- 💾 SECCIÓN 6: Dispositivos Vinculados -->
      <div class="glass-card section">
        <div class="section-title">
          <span>💾 Dispositivos Vinculados</span>
          <span class="section-badge" id="devicesBadge" style="display:none;">3 dispositivos</span>
        </div>
        
        <div class="devices-list">
          <div class="device-item">
            <div class="device-icon">📱</div>
            <div class="device-info">
              <div class="device-name">iPhone 15 Pro</div>
              <div class="device-details">Última conexión: Hace 2 horas</div>
            </div>
            <button class="btn ghost small" id="removeDevice1">Eliminar</button>
          </div>
          
          <div class="device-item">
            <div class="device-icon">💻</div>
            <div class="device-info">
              <div class="device-name">MacBook Pro</div>
              <div class="device-details">Última conexión: Ayer</div>
            </div>
            <button class="btn ghost small" id="removeDevice2">Eliminar</button>
          </div>
          
          <div class="device-item">
            <div class="device-icon">🖥️</div>
            <div class="device-info">
              <div class="device-name">Chrome - Windows</div>
              <div class="device-details">Última conexión: Hace 3 días</div>
            </div>
            <button class="btn ghost small" id="removeDevice3">Eliminar</button>
          </div>
        </div>
      </div>

      <!-- 🧾 SECCIÓN 7: Actividad de la cuenta -->
      <div class="glass-card section">
        <div class="section-title">
          <span>🧾 Actividad de la cuenta</span>
          <span class="section-badge" id="activityBadge" style="display:none;">Reciente</span>
        </div>
        
        <div class="activity-list">
          <div class="activity-item">
            <div class="activity-icon">🔐</div>
            <div class="activity-content">
              <div class="activity-title">Inicio de sesión exitoso</div>
              <div class="activity-details">iPhone 15 Pro • Madrid, España</div>
              <div class="activity-time">Hace 2 horas</div>
            </div>
          </div>
          
          <div class="activity-item">
            <div class="activity-icon">🔑</div>
            <div class="activity-content">
              <div class="activity-title">Contraseña actualizada</div>
              <div class="activity-details">Cambio de contraseña completado</div>
              <div class="activity-time">Hace 1 día</div>
            </div>
          </div>
          
          <div class="activity-item">
            <div class="activity-icon">📧</div>
            <div class="activity-content">
              <div class="activity-title">Email verificado</div>
              <div class="activity-details">Nueva dirección de email confirmada</div>
              <div class="activity-time">Hace 3 días</div>
            </div>
          </div>
          
          <div class="activity-item">
            <div class="activity-icon">⚠️</div>
            <div class="activity-content">
              <div class="activity-title">Intento de inicio de sesión fallido</div>
              <div class="activity-details">Ubicación desconocida • IP: 192.168.1.1</div>
              <div class="activity-time">Hace 1 semana</div>
            </div>
          </div>
        </div>
      </div>

      <!-- ❓ SECCIÓN 8: Soporte y Ayuda -->
      <div class="glass-card section">
        <div class="section-title">
          <span>❓ Soporte y Ayuda</span>
          <span class="section-badge" id="supportBadge" style="display:none;">Disponible</span>
        </div>
        
        <div class="support-options">
          <div class="support-item">
            <div class="support-icon">📚</div>
            <div class="support-content">
              <div class="support-title">Centro de ayuda</div>
              <div class="support-description">Encuentra respuestas a tus preguntas</div>
            </div>
            <button class="btn ghost" id="helpCenterBtn">Abrir</button>
          </div>
          
          <div class="support-item">
            <div class="support-icon">💬</div>
            <div class="support-content">
              <div class="support-title">Contactar con soporte</div>
              <div class="support-description">Habla con nuestro equipo de soporte</div>
            </div>
            <button class="btn ghost" id="contactSupportBtn">Contactar</button>
          </div>
          
          <div class="support-item">
            <div class="support-icon">❓</div>
            <div class="support-content">
              <div class="support-title">Preguntas frecuentes</div>
              <div class="support-description">Respuestas a las preguntas más comunes</div>
            </div>
            <button class="btn ghost" id="faqBtn">Ver FAQ</button>
          </div>
          
          <div class="support-item">
            <div class="support-icon">💭</div>
            <div class="support-content">
              <div class="support-title">Chat en vivo</div>
              <div class="support-description">Soporte instantáneo por chat</div>
            </div>
            <button class="btn ghost" id="liveChatBtn">Iniciar chat</button>
          </div>
        </div>
      </div>

      <!-- 🚪 SECCIÓN 9: Cierre de sesión y eliminación -->
      <div class="glass-card section danger-section">
        <div class="section-title">
          <span>🚪 Cierre de sesión y eliminación</span>
        </div>
        
        <div class="danger-actions">
          <div class="danger-item">
            <div class="danger-content">
              <div class="danger-title">Cerrar sesión</div>
              <div class="danger-description">Cierra tu sesión en todos los dispositivos</div>
            </div>
            <button class="btn ghost" id="logoutAllBtn">Cerrar sesión</button>
          </div>
          
          <div class="danger-item">
            <div class="danger-content">
              <div class="danger-title">Eliminar cuenta</div>
              <div class="danger-description">Elimina permanentemente tu cuenta y todos los datos</div>
            </div>
            <button class="btn danger" id="deleteAccountBtn">Eliminar cuenta</button>
          </div>
        </div>
      </div>

      <!-- Sección información personal (original) -->
      <div class="glass-card section">
        <div class="section-title">
          <span>Información personal</span>
          <span class="section-badge" id="personalBadge" style="display:none;">Privado</span>
        </div>
        <div id="personalInfo" class="muted">Inicia sesión para ver y editar tu información personal.</div>
      </div>

      <!-- Sección productos favoritos (original) -->
      <div class="glass-card section">
        <div class="section-title">
          <span>Favoritos</span>
          <span class="section-badge" id="favBadge" style="display:none;">Solo tú</span>
        </div>
        <div id="favoritesList" class="favorites-list">
          <div class="empty-state">Inicia sesión para ver tus productos favoritos.</div>
        </div>
      </div>

      <!-- Sección productos comprados (original) -->
      <div class="glass-card section">
        <div class="section-title">
          <span>Productos comprados</span>
          <span class="section-badge" id="purchasedBadge" style="display:none;">Historial</span>
        </div>
        <div id="purchasedList" class="purchased-list">
          <div class="empty-state">Inicia sesión para ver tus productos comprados.</div>
        </div>
      </div>
    </div>
  </main>

  <script type="module" src="auth-firebase-minimal.js"></script>
  <script>
  (function(){
    // --- Navegación y accesibilidad ---
    const brandEl = document.getElementById('brand');
    brandEl.addEventListener('click', ()=> location.href='index.html');
    brandEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); brandEl.click(); } });

    // --- UI refs ---
    const profileNameEl = document.getElementById('profileName');
    const profileEmailEl = document.getElementById('profileEmail');
    const profileStatusEl = document.getElementById('profileStatus');
    const avatarImgEl = document.getElementById('profileAvatar');
    const loginBtn = document.getElementById('loginNowBtn');
    const signOutBtn = document.getElementById('signOutBtn');
    const saveBtn = document.getElementById('saveProfileBtn');
    const displayNameInput = document.getElementById('displayNameInput');
    const phoneInput = document.getElementById('phoneInput');
    const addressInput = document.getElementById('addressInput');
    const personalInfo = document.getElementById('personalInfo');
    const favoritesList = document.getElementById('favoritesList');
    const purchasedList = document.getElementById('purchasedList');
    const ordersList = document.getElementById('ordersList');

    // Badges
    const personalBadge = document.getElementById('personalBadge');
    const favBadge = document.getElementById('favBadge');
    const purchasedBadge = document.getElementById('purchasedBadge');
    const ordersBadge = document.getElementById('ordersBadge');

    const LS_USER = 'lixby_user';

    // --- Helpers ---
    function readLocalSnapshot(){
      try { return JSON.parse(localStorage.getItem(LS_USER)||'null'); } catch(e){ return null; }
    }
    function currentFirebaseUser(){
      try {
        const auth = window.appAuth && window.appAuth._rawAuth;
        const u = auth && auth.currentUser;
        if (!u) return null;
        return {
          uid: u.uid,
          displayName: u.displayName || (u.email ? u.email.split('@')[0] : 'Usuario'),
          email: u.email || '',
          photoURL: u.photoURL || '',
          isAnonymous: !!u.isAnonymous
        };
      } catch(e){ return null; }
    }
    function placeholderAvatarForName(name, size=100){
      const initials = (String(name||'Lixby').trim().split(/\s+/).slice(0,2).map(s=>s[0]||'').join('').toUpperCase() || 'LX');
      return `https://via.placeholder.com/${size}?text=${encodeURIComponent(initials)}`;
    }

    function showSkeleton(listEl, count=3){
      listEl.innerHTML = '';
      for(let i=0;i<count;i++){
        const div = document.createElement('div');
        div.className = 'skeleton';
        listEl.appendChild(div);
      }
    }

    function renderAccountUI(u){
      const isUser = !!u && !!u.uid;
      const displayName = (u && (u.name || u.displayName)) || 'Invitado';
      const email = (u && u.email) || '';
      const isAnon = !!(u && u.isAnonymous);

      profileNameEl.textContent = displayName;
      profileEmailEl.textContent = email || (isAnon ? 'Invitado' : '');
      profileStatusEl.textContent = isUser ? (isAnon ? 'Invitado (autenticado)' : 'Autenticado') : 'No autenticado';

      const photo = (u && u.photoURL) || placeholderAvatarForName(displayName, 100);
      avatarImgEl.src = photo; avatarImgEl.alt = displayName + ' avatar';

      loginBtn.style.display = isUser ? 'none' : '';
      sign
