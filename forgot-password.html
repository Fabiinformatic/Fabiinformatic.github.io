<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Recuperar contraseña — LIXBY</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="wrap">
    <section style="max-width:520px;margin:48px auto" class="panel">
      <h1>Recuperar contraseña</h1>
      <p class="small">Introduce el correo asociado y te enviaremos instrucciones.</p>
      <form id="fpForm" novalidate>
        <label for="fpEmail">Correo electrónico</label>
        <input id="fpEmail" type="email" autocomplete="email" />
        <div id="err-fpEmail" class="errorsmall" aria-live="polite"></div>
        <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
          <a href="login.html" class="btn ghost">Volver</a>
          <button class="btn primary" type="submit">Enviar instrucciones</button>
        </div>
        <div id="fpStatus" class="small muted" style="margin-top:10px" aria-live="polite"></div>
      </form>
    </section>
  </main>

  <script type="module" src="auth-firebase-minimal.js"></script>
  <script>
    (function(){
      const form = document.getElementById('fpForm');
      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        document.getElementById('err-fpEmail').textContent = '';
        const email = (document.getElementById('fpEmail').value||'').trim();
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { document.getElementById('err-fpEmail').textContent = 'Introduce una dirección válida.'; return; }
        document.getElementById('fpStatus').textContent = 'Enviando…';
        try {
          if (window.appAuth && typeof window.appAuth.resetPassword === 'function') {
            await window.appAuth.resetPassword(email);
            document.getElementById('fpStatus').textContent = 'Si existe la cuenta, recibirás un email con instrucciones.';
          } else {
            // fallback
            document.getElementById('fpStatus').textContent = 'Demo: si existiera la cuenta, recibirías un email.';
          }
        } catch(err) {
          console.warn(err);
          document.getElementById('fpStatus').textContent = 'Error enviando instrucciones: ' + (err && err.message || '');
        }
      });
    })();
  </script>
</body>
</html>
